@page "/"
@attribute [Authorize]
@using Drogecode.Knrm.Oefenrooster.Client.Pages.Components
@using System.Text;
@using Drogecode.Knrm.Oefenrooster.Client.Pages.Planner.Components
@using Drogecode.Knrm.Oefenrooster.Client.Pages.Dashboard.Components;
@using Drogecode.Knrm.Oefenrooster.Shared.Models.SharePoint;
@using Drogecode.Knrm.Oefenrooster.Shared.Models.User;
@using System.Web;
@using System.Text.RegularExpressions;
@using Drogecode.Knrm.Oefenrooster.Shared.Models.TrainingTypes;
<PageTitle>Dashboard</PageTitle>

<MudPaper Elevation="0" Class="p-2">
    <MudTabs Rounded="true">
        <MudTabPanel Text="@L["Planner"]">
            @if (_pinnedTrainings != null)
            {
                @if (_pinnedTrainings.Count() > 0)
                {
                    <MudText Typo="Typo.h3">@L["Pinned trainings"]</MudText>
                    <MudPaper Elevation="0" Class="d-flex align-content-start flex-wrap flex-grow-1 gap-4 mx-2 my-4">
                        @foreach (var training in _pinnedTrainings)
                        {
                            <CalendarCard Width="200px" Training="training" ShowDate=true />
                        }
                    </MudPaper>
                }
            }
            else
            {
                <MudSkeleton />
                <MudSkeleton />
                <MudSkeleton />
                <MudSkeleton />
            }
            <MudText Typo="Typo.h3">@L["Future trainings"]</MudText>

            @if (_futureTrainings != null)
            {
                @if (_futureTrainings.Count() > 0)
                {
                    <MudPaper Elevation="0" Class="d-flex align-content-start flex-wrap flex-grow-1 gap-4 mx-2 my-4">
                        @foreach (var training in _futureTrainings)
                        {
                            <IndexCard User="_user" Training="training" Functions="_functions" Users="_users" TrainingTypes="_trainingTypes" Vehicles="_vehicles" />
                        }
                    </MudPaper>
                }
                else
                {
                    <MudText Typo="Typo.h4">@L["No future trainings"]</MudText>
                }
            }
            else
            {
                <MudSkeleton />
                <MudSkeleton />
                <MudSkeleton />
                <MudSkeleton />
            }
        </MudTabPanel>
        <MudTabPanel Text="@L["Actions"]">
            <ActionsTab User="@_user" Users="@_users" Functions="@_functions"/>
        </MudTabPanel>
        <MudTabPanel Text="@L["Trainings"]">
            <TrainingsTab/>
        </MudTabPanel>
    </MudTabs>
</MudPaper>