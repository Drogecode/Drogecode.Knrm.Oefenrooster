@page "/"
@attribute [Authorize]
@using System.Text;
@using Drogecode.Knrm.Oefenrooster.Client.Pages.Planner.Components
@using Drogecode.Knrm.Oefenrooster.Client.Pages.Dashboard.Components;
@using Drogecode.Knrm.Oefenrooster.Shared.Models.SharePoint;
@using Drogecode.Knrm.Oefenrooster.Shared.Models.User;
@using System.Web;
@using System.Text.RegularExpressions;
@using Drogecode.Knrm.Oefenrooster.Shared.Models.TrainingTypes;
<PageTitle>Dashboard</PageTitle>

<MudPaper Elevation="0" Class="p-2">
    <DrogeCodeMudTabs Rounded="true">
        <DrogeCodeMudTabPanel Text="@L["Planner"]">
            @if (_dayItems != null && _dayItems.Count() > 0)
            {
                <MudText Typo="Typo.h5">@L["Special days"]</MudText>
                <MudPaper Elevation="0" Class="p-2">
                    <MudGrid Spacing="2" Justify="Justify.FlexStart">
                        @foreach (var item in _dayItems)
                        {
                            <MudItem xs="12" sm="6" md="4" lg="3">
                                <MudText>
                                    @item.Text <DateToString DateTimeLocal="item.DateStart" />
                                </MudText>
                            </MudItem>
                        }
                    </MudGrid>
                </MudPaper>
            }
            @if (_pinnedTrainings != null)
            {
                @if (_pinnedTrainings.Count() > 0)
                {
                    <MudText Typo="Typo.h3">@L["Pinned trainings"]</MudText>
                    <MudPaper Elevation="0" Class="flex align-content-start flex-wrap flex-grow-1 gap-4 mx-2 my-4">
                        @foreach (var training in _pinnedTrainings)
                        {
                            <div class="flex-1">
                                <CalendarCard MinWidth="300px" MaxWidth="600px" Training="training" ShowDate=true />
                            </div>
                        }
                    </MudPaper>
                }
            }
            else
            {
                <MudSkeleton />
                <MudSkeleton />
                <MudSkeleton />
                <MudSkeleton />
            }
            <MudText Typo="Typo.h3">@L["Future trainings"]</MudText>
            @if (_futureTrainings != null)
            {
                @if (_futureTrainings.Count() > 0)
                {
                    <MudPaper Elevation="0" Class="d-flex align-content-start flex-wrap flex-grow-1 gap-4 mx-2 my-4">
                        @foreach (var training in _futureTrainings)
                        {
                            <div class="flex-1">
                                <IndexCard MinWidth="300px" MaxWidth="600px" User="_user" Training="training" Functions="_functions" Users="_users" TrainingTypes="_trainingTypes" Vehicles="_vehicles" />
                            </div>
                        }
                    </MudPaper>
                }
                else
                {
                    <MudText Typo="Typo.h4">@L["No future trainings"]</MudText>
                }
            }
            else
            {
                <MudSkeleton />
                <MudSkeleton />
                <MudSkeleton />
                <MudSkeleton />
            }
        </DrogeCodeMudTabPanel>
        <DrogeCodeMudTabPanel Text="@L["Actions"]">
            <ActionsTab User="@_user" Users="@_users" Functions="@_functions" />
        </DrogeCodeMudTabPanel>
        <DrogeCodeMudTabPanel Text="@L["Trainings"]">
            <TrainingsTab User="@_user" Users="@_users" Functions="@_functions" />
        </DrogeCodeMudTabPanel>
    </DrogeCodeMudTabs>
</MudPaper>